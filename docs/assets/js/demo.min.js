!function(t){var e={};function s(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=e,s.d=function(t,e,r){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(r,i,function(e){return t[e]}.bind(null,i));return r},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=13)}([function(t,e,s){"use strict";s.d(e,"a",(function(){return n})),s.d(e,"b",(function(){return i}));const r=180/Math.PI;Math.__proto__.radiansToDegrees||(Math.__proto__.radiansToDegrees=t=>t*r),Math.__proto__.degreesToRadians||(Math.__proto__.degreesToRadians=t=>t*r);class i{static instanceofVector(t){if(!t instanceof n){throw new TypeError("Arg is not an instance of Vector2D, input type was "+typeof t)}}static validate(...t){t.forEach(t=>{i.instanceofVector(t)})}}class n{setX(t){return this._x=t,this}getX(){return this._x}setY(t){return this._y=t,this}getY(){return this._y}set(t,e){return this.setX(t),this.setY(e),this}static fromArray(t=[]){if(t=t||[],!Array.isArray(t))throw new TypeError(`Vector.fromArray() arg is not an array, type was '${typeof t}'`);return new n(t[0]||0,t[1]||0)}static fromObject(t){return new n((t=t||{}).x||0,t.y||0)}constructor(t=0,e=0){this.setX(t),this.setY(e)}add(t){return i.validate(t),this.setX(this.getX()+t.getX()),this.setY(this.getY()+t.getY()),this}addX(t){return this.setX(this.getX()+t),this}addY(t){return this.setY(this.getY()+t),this}static add(t,e){return i.validate(t,e),new n(t.getX()+e.getX(),t.getY()+e.getY())}static addX(t,e){return i.validate(t,e),new n(t.getX()+e.getX(),t.getY())}static addY(t,e){return i.validate(t,e),new n(t.getX(),t.getY()+e.getY())}addScalar(t){return this.addX(t),this.addY(t),this}static addScalar(t,e){return i.validate(t),t.addX(e),t.addY(e),t}substractScalarX(t){return this.setX(this.getX()-t),this}substractScalarY(t){return this.setY(this.getY()-t),this}substract(t){return i.validate(t),this.substractScalarX(t.getX()),this.substractScalarY(t.getY()),this}static substract(t,e){return i.validate(t,e),new n(t.getX()-e.getX(),t.getY()-e.getY())}multiply(t){return i.validate(t),this.multiplyX(t),this.multiplyY(t),this}multiplyScalar(t){return this.setX(this.getX()*t),this.setY(this.getY()*t),this}multiplyX(t){return i.validate(t),this.setX(this.getX()*t.getX()),this}multiplyY(t){return i.validate(t),this.setY(this.getY()*t.getY()),this}static multiply(t,e){return i.validate(t,e),new n(t.getX()*e.getX(),t.getY()*e.getY())}divide(t){return i.validate(t),this._x=this.getX()/t.getX(),this._y=this.getY()/t.getY(),this}divideScalar(t){return this.setX(this.getX()/t),this.setY(this.getY()/t),this}divideScalarX(t){const e=this.getX()/t;return this.setX(e),this}divideScalarY(t){return this.setY(this.getY()/t),this}static divide(t,e){return i.validate(t,e),new n(t.getX()/e.getX(),t.getY()/e.getY())}dot(t){return i.validate(t),this.getX()*t.getX()+this.getY()*t.getY()}static dot(t,e){return i.validate(t,e),t.getX()*e.getX()+t.getY()*e.getY()}cross(t){return i.validate(t),this.getX()*t.getY()-this.getY()*t.getX()}static cross(t,e){return i.validate(t,e),t.getX()*e.getY()-t.getY()*e.getX()}magnitude(){return Math.sqrt(this.dot(this))}static magnitude(t,e){return i.validate(t,e),Math.sqrt(n.dot(t,e))}magnitudeSq(){return Math.pow(this.getX(),2)+Math.pow(this.getY(),2)}static magnitudeSq(t){return i.validate(t),Math.pow(t.getX(),2)+Math.pow(t.getY(),2)}horizontalAngle(){return Math.atan2(this.getY(),this.getX())}angle(){return this.horizontalAngle()}rotate(t){return this._x=this.getX()*Math.cos(t)-this.getY()*Math.sin(t),this._y=this.getX()*Math.sin(t)+this.getY()*Math.cos(t),this}rotateDegrees(t){return this.rotate(Math.degreesToRadians(t)),this}rotateBy(t){return this.rotate(this.angle()+t)}rotateByDegrees(t){return this.rotateBy(this.angle()+Math.radiansToDegrees(t))}xlt(t){return this.getX()<t.getX()}ylt(t){return this.getY()<t.getY()}lt(t){return this.xlt(t)&&this.ylt(t)}xle(t){return this.getX()<=t.getX()}yle(t){return this.getY()<=t.getY()}le(t){return this.xle(t)&&this.yle(t)}xgt(t){return this.getX()>t.getX()}ygt(t){return this.getY()>t.getY()}gt(t){return this.xgt(t)&&this.ygt(t)}xge(t){return this.getX()>=t.getX()}yge(t){return this.getY()>=t.getY()}ge(t){return this.xle(t)&&this.yle(t)}clamp(t,e,s=!0){return i.validate(t),i.validate(e),s?(this.getX()<t.getX()&&this.setX(t.getX()),this.getX()>e.getY()&&this.setX(e.getY()),this.getY()<t.getY()&&this.setY(t.getY()),this.getY()>e.getY()&&this.setY(e.getY())):(this.getX()<=t.getX()&&this.setX(t.getX()),this.getX()>=e.getY()&&this.setX(e.getY()),this.getY()<=t.getY()&&this.setY(t.getY()),this.getY()>=e.getY()&&this.setY(e.getY())),this}clone(){return new n(this.getX(),this.getY())}toArray(){return[this.getX(),this.getY()]}toString(t=","){return this.toArray().join(t)}toObject(){return{x:this.getX(),y:this.getY()}}round(){this.setX(Math.round(this._x)),this.setY(Math.round(this._y))}floor(){this.setX(Math.floor(this._x)),this.setY(Math.floor(this._y))}copy(t){return i.validate(t),this.setX(t.getX()),this.setY(t.getY()),this}equals(t){return i.validate(t),this.getX()===t.getX()&&this.getY()===t.getY()}static equals(t,e){return i.validate(t,e),t.getX()===e.getX()&&t.getY()===e.getY()}zero(){return this.setX(0),this.setY(0),this}static zero(t){i.validate(t),t._x=0,t._y=0}isZero(){return 0===this.getX()&&0===this.getY()}static isZero(t){return i.validate(t),0===t.getX()&&0===t.getY()}length(){return this.magnitude()}static length(t,e){return i.validate(t,e),n.magnitude(t,e)}negative(){return this.setX(-this.getX()),this.setY(-this.getY()),this}negativeX(){return this.setX(-this.getX()),this}negativeY(){return this.setY(-this.getY()),this}static negative(t){return i.validate(t),new n(-t.getX(),-t.getY())}distanceX(t){return i.validate(t),this.getX()-t.getX()}distanceAbs(t){return i.validate(t),new n(this.distanceXAbs(t),this.distanceYAbs(t))}distanceXAbs(t){return i.validate(t),Math.abs(this.distanceX(t))}distanceY(t){return i.validate(t),this.getY()-t.getY()}distanceYAbs(t){return i.validate(t),Math.abs(this.distanceY(t))}distance(t){return i.validate(t),Math.sqrt(this.distanceSq(t))}distanceSq(t){return i.validate(t),this.distanceX(t)*this.distanceX(t)+this.distanceY(t)*this.distanceY(t)}normalize(){const t=this.length();return 0===t?(this.setX(1),this.setY(0)):this.divide(new n(t,t)),this}}},function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));var r=s(2),i=s(0),n=s(7);s(6),s(11);class a extends r.b{getGenerator(t){return t.getCells().getGenerator()}cellToCanvasCoordinates(t,e){return n.a.toCanvas(t,e.width,e.height)}isDrawable(t=null){return!0}drawImageBitmap(t,e=null){const s=e||new i.a;this.getCtx().drawImage(t,s.getX(),s.getY())}_draw([t,e]){createImageBitmap(e.imgData).then(e=>{const s=this.getGenerator(t);for(let t of s){const s=this.cellToCanvasCoordinates(t,e);this.isDrawable(t)&&this.drawImageBitmap(e,s)}})}}},function(t,e,s){"use strict";s.d(e,"b",(function(){return i})),s.d(e,"a",(function(){return n}));class r{getCtx(t=null,e={}){}_clear(t){}draw(...t){this.getCtx().save(),this._clear(t),this._draw(t),this.getCtx().restore()}_draw(t){}}class i extends r{getCtx(t="2d",e={alpha:!0}){return this._canvas.getContext(t,e)}constructor(t){super(),this._canvas=t}_clear(...t){this.getCtx().clearRect(0,0,this._canvas.width,this._canvas.height)}_draw(...t){}}class n extends r{getCtx(t="2d",e={alpha:!0}){return this._offScreen.getContext(t,e)}getOffScreenImageBitmap(){return this._offScreen.transferToImageBitmap()}drawOffScreenCanvas(t="2d",e={alpha:!0}){this.getCtx(t).drawImage(this._image,0,0)}constructor(t,e,s=!0){super(),this._canvas=t,this._offScreen=new OffscreenCanvas(e.width,e.height),this._image=e,s&&this.drawOffScreenCanvas()}_draw(...t){this._canvas.getContext("bitmaprenderer").transferFromImageBitmap(this.getOffScreenImageBitmap())}}},function(t,e,s){"use strict";e.a=(t,e)=>t+(e-t+1)*crypto.getRandomValues(new Uint32Array(1))[0]/2**32|0},function(t,e,s){"use strict";s.d(e,"a",(function(){return i}));var r=s(0);class i{setOrigin(t){this._origin=t}getOrigin(){return this._origin}getIndex(){return this._index}setIsBuildable(t){this._buildable=t}isBuildable(){return this._buildable}setHasRoad(t){this._hasRoad=t}hasRoad(){return this._hasRoad}isEvenRow(){return this._index.getY()%2==0}isOddRow(){return!this.isEvenRow()}isEvenCol(){return this._index.getX()%2==0}isOddCol(){return!this.isEvenCol()}constructor(t=null,e=null,s=!1,i=!1){this._index=t||new r.a,this._origin=e||new r.a,this._buildable=s,this._hasRoad=i}}},function(t,e,s){"use strict";s.d(e,"a",(function(){return n}));var r=s(4),i=s(0);class n{constructor(t){this._dimensions=t;const e=new Array(t.getY()).fill(null);Object.seal(e);for(let s=0;s<e.length;s++){let n=[];for(let e=0;e<t.getX();e++)n.push(new r.a(new i.a(e,s),new i.a(e,s)));Object.seal(n),e[s]=n}this._rows=e}getRows(){return this._rows}hasRow(t){return void 0!==this._rows[t]}hasCol(t){return void 0!==this._rows[0][t]}hasCell(t,e){return!(!this.hasRow(e)||void 0===this._rows[e][t])}getCell(t,e){return!!this.hasCell(t,e)&&this._rows[e][t]}getCellByVector(t){return this.getCell(t.getX(),t.getY())}*getGenerator(){for(const t of this._rows)for(const e of t)yield e}}},function(t,e,s){"use strict";s.d(e,"a",(function(){return i}));var r=s(0);s(4),s(5);class i{getDimensions(){return this._dimensions}getOrigin(){return this._origin}getCells(){return this._cells}constructor(t,e,s=null){this._dimensions=t,this._cells=e,this._origin=s||new r.a}getAdjacents(t,e,s=1,i=!1){const n=2*s+1,a=new r.a(t-s,e-s),h=[];for(let r=1;r<=n;r++){for(let r=1;r<=n;r++)!1==(a.getX()===t&&a.getY()===e)&&h.push(this._cells.getCell(a.getX(),a.getY())),a.getY()>=e+s?a.setY(e-s):a.addY(1);a.addX(1)}return h}}},function(t,e,s){"use strict";s.d(e,"a",(function(){return i}));var r=s(0);class i{static toCanvas(t,e,s){s=s%2!=0?s-1:s;let i=(e=e%2!=0?e-1:e)*t.getOrigin().getX(),n=s*t.getOrigin().getY();return t.getOrigin().getY()%2!=0&&(i+=e/2),n-=t.getOrigin().getY()*(s/2),new r.a(i,n)}}},function(t,e,s){"use strict";s.d(e,"a",(function(){return i}));var r=s(1);class i extends r.a{}},function(t,e,s){"use strict";s.d(e,"a",(function(){return i}));var r=s(1);class i extends r.a{isDrawable(t=null){return t.hasRoad()}}},function(t,e,s){"use strict";s.d(e,"a",(function(){return h}));var r=s(12),i=s(3),n=s(0);s(4);class a{constructor(t){this._cell=t,this._index=t.getIndex()}getNorth(){return n.a.add(this._index,new n.a(0,-2))}getNorthEast(){let t=null;return t=this._cell.isEvenRow()?n.a.add(this._index,new n.a(0,-1)):n.a.add(this._index,new n.a(1,-1)),t}getEast(){return n.a.add(this._index,new n.a(1,0))}getSouthEast(){let t=null;return t=this._cell.isEvenRow()?n.a.add(this._index,new n.a(0,1)):n.a.add(this._index,new n.a(1,1)),t}getSouth(){return n.a.add(this._index,new n.a(0,2))}getSouthWest(){let t=new n.a;return t=this._cell.isEvenRow()?n.a.add(this._index,new n.a(-1,1)):n.a.add(this._index,new n.a(0,1)),t}getWest(){return n.a.add(this._index,new n.a(-1,0))}getNorthWest(){let t=null;return t=this._cell.isEvenRow()?n.a.add(this._index,new n.a(-1,-1)):n.a.add(this._index,new n.a(0,-1)),t}}class h extends r.Chunk{constructor(t,e){super(t,e),this._generateRoad()}_generateRoad(){let t=Object(i.a)(0,this.getDimensions().getX());Object(i.a)(0,this.getDimensions().getY());let e=new n.a(t,0);for(let t=0;t<330;t++){const t=this.getCells().getCellByVector(e);if(!1===t)break;const s=new a(t);this.getCells().getCellByVector(e).setHasRoad(!0),e=s.getSouthEast(t)}}}},function(t,e,s){"use strict";s.d(e,"a",(function(){return o}));var r=s(0);class i extends r.a{setZ(t){this._z=t}getZ(){return this._z}constructor(t=0,e=0,s=0){super(t,e),this._z=s,this.clamp(new r.a(0,0),new r.a(256,256))}equals(t){return super.equals(t)&&this._z===t.getZ()}clamp(t,e,s=!0){return super.clamp(t,e,s),!0===s&&(this.getZ()<t.getX()&&this.setZ(t.getX()),this.getZ()>e.getY()&&this.setZ(e.getY())),this}}class n{getTransparencyColor(){return this._transparentColor}get imgData(){return this._imgData}constructor(t){this._imgData=t,this._transparentColor=null}setTransparencyColor(t,e,s){this._transparentColor=new i(t,e,s)}resetTransparencyColor(){return this._transparentColor=null,this}hasTransparencyColor(){return!(null==this._transparentColor)}applyTransparency(){if(this.hasTransparencyColor())for(let t=0;t<this._imgData.data.length;t+=4){const e=new i(this._imgData.data[t],this._imgData.data[t+1],this._imgData.data[t+2]);this.getTransparencyColor().equals(e)&&(this._imgData.data[t+3]=0)}}}class a extends n{getDuration(){return this._duration}constructor(t,e){super(t[0]),this._map=t,this._currentFrame=0,this._duration=e}step(){this._currentFrame+=1,this._currentFrame>this._map.length-1&&(this._currentFrame=0),this._imgData=this._map[this._currentFrame]}}var h=s(2);h.b;class o{getMap(){return this._map}get(t){return this._map.get(t)}constructor(t,e){this._json=t,this._context=e,this._map=new Map,this.build()}_buildSprite(t){const e=this._context.getImageData(t.origin[0],t.origin[1],t.dimensions[0],t.dimensions[1]),s=new n(e);return null!=t.transparency&&s.setTransparencyColor(t.transparency[0],t.transparency[1],t.transparency[2]),s}build(){const t=this._json.tiles,e=this._json.animations;if(void 0!==t)for(let[e,s]of Object.entries(t))this._map.set(e,this._buildSprite(s));if(void 0!==e)for(let[t,s]of Object.entries(e)){const e=s.duration,r=s.tiles,i=[];r.forEach(t=>{i.push(this.get(t).imgData)});const n=new a(i,e);this._map.set(t,n)}}}},function(t,e,s){"use strict";s.r(e),s.d(e,"Cell",(function(){return r.a})),s.d(e,"Cells",(function(){return i.a})),s.d(e,"Chunk",(function(){return n.a})),s.d(e,"ArrayHelper",(function(){return h})),s.d(e,"CellToCanvas",(function(){return o.a})),s.d(e,"rand",(function(){return g.a})),s.d(e,"AbstractRender",(function(){return u.a})),s.d(e,"RenderChunk",(function(){return l.a})),s.d(e,"RoadsRender",(function(){return c.a})),s.d(e,"Road",(function(){return d.a})),s.d(e,"World",(function(){return _}));var r=s(4),i=s(5),n=s(6),a=s(0);class h{static vectorToIndex(t,e){return a.b.validate(t,e),e.getX()+t.getX()*e.getY()}static indexToVector(t,e){a.b.validate(t);const s=e%t.getX(),r=e/t.getX();return new a.a(s,r)}static diagonal(t){const e=Math.sqrt(t.length),s=[];for(let r=0;r<=2*(e-1);++r)for(let i=e-1;i>=0;--i){const n=r-i;if(n>=0&&n<e){const e=h.vectorToIndex(new a.a(3),new a.a(n,i));s.push(t[e])}}return s}}var o=s(7),g=s(3),u=s(1),l=s(8),c=s(9),d=s(10);class _{}},function(t,e,s){"use strict";s.r(e);var r=s(11),i=s(2);class n{static image(t){return new Promise((e,s)=>{const r=new Image;r.addEventListener("load",()=>e(r)),r.addEventListener("error",t=>s(t)),r.src=t})}static json(t){return fetch(t).then(t=>t.json()).catch(t=>t)}}var a=s(0),h=s(6),o=s(8),g=(s(3),s(10)),u=s(9),l=s(5);window.addEventListener("DOMContentLoaded",t=>{const e=document.getElementById("world"),s=n.image("assets/img/tiles.png"),c=n.json("assets/img/tiles.json"),d=n.image("assets/img/commercials.png"),_=n.json("assets/img/commercials.json"),Y=n.image("assets/img/infrastructures.png"),f=n.json("assets/img/infrastructures.json");Promise.all([s,c,d,_,Y,f]).then(([t,s,n,c,d,_])=>{const Y=new i.a(e,t),f=new r.a(s,Y.getCtx()),X=new i.a(e,d),w=new r.a(_,X.getCtx()),v=new i.a(e,n),p=(new r.a(c,v.getCtx()),new a.a(22,39)),m=new l.a(p),y=new h.a(p,m),x=new o.a(e),C=new g.a(p,m),b=new u.a(e);x.draw(y,f.get("tiles-1")),b.draw(C,w.get("right-to-left"))}).catch(t=>{console.log(t)})})}]);